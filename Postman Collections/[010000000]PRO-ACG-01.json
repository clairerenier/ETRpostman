{
  "variables": [],
  "info": {
    "name": "[010000000]PRO-ACG-01",
    "_postman_id": "dfdaa9fc-6991-9322-f297-c18be0096d75",
    "description": "Object used : \nFGA : C220",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "_postman_id": "396c3b69-1e90-8c7e-971b-8e30711b6996",
      "name": "[011102400]PRO_ACG_11_FGA_ACG_024_C220",
      "description": "0-First file dropped to generate data\r\n\tExpected result : everything is saved (all hours set to OUI)\r\no\t1  Same file dropped with the following changes : \r\n"\tMETMOY 8h has its value changed (89,63 to 90.63)\r\n"\tNothing changed for 9AM\r\no\t2  Same file dropped with the following changes : \r\n"\tDENMOY 7h quality will be AF (M before)\r\n"\tMETMOY 8h has its value changed (90,63 to 91.63)\r\n"\tNothing changed for 9AM\r\n\tExpected result : 7 and 8AM whould be set to OUI , and NON for 9h\r\no\t3  Same file dropped where :\r\n"\t9AM is changed PCSMOY will be CS (quality = to the previous one)\r\n"\tMETMOY 8h has its value changed (91,63 to 89.63)\r\n\tExpected result : all set to NON except 8AM\r\no\t4 - Same file dropped where only 8AM is changed PCSMOY from AF to CS (quality <)\r\n\tExpected result : all set to NON\r\no\t5  Same file dropped but PCSMOY to CS for 8h\r\n\tExpected result : 8AM set to OUI\r\no\t6- file on a fresh gaz day :\r\n\tExpeted result : all hours set to OUI\r\no\t7  file to test\r\n\tRun first file\r\n"\tPCSMOY is set to 6/7/8AM AF, rest are set to CS\r\n"\tExpected results : everything set to OUI\r\n\tRun second file\r\n"\tPCSMOY is unchanged for 678, for rest of the hours, they are set to AF\r\n"\tExpected results everything set to OUI except 6/7/8AM",
      "item": [
        {
          "_postman_id": "4e28a05a-8c37-4ffb-2c22-e0bae3d97d67",
          "name": "[011102400]Delete and Update data",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "var sqlResult = jsonData.sqlResult;",
                  "for(var i= 0; i < sqlResult.length; i++)",
                  "{",
                  "    switch (sqlResult[i].requestId) {",
                  "        case \"UpdatePointData\":",
                  "            tests[\"Update Point Data\"] = true;",
                  "            break;",
                  "        case \"DeletePointData\":",
                  "            tests[\"Delete Point Data\"] = true;",
                  "            break;",
                  "        case \"DeleteAcqFgaData\":",
                  "            tests[\"Delete Acq_Fga Data\"] = true;",
                  "            break;",
                  "        case \"DeletePubPointJmnFgaData\":",
                  "            tests[\"Delete Pub_Point_Jmn_Fga Data\"] = true;",
                  "            break;",
                  "    }",
                  "}",
                  "if (tests[\"Update Point Data\"] && tests[\"Delete Point Data\"] && tests[\"Delete Acq_Fga Data\"] && tests[\"Delete Pub_Point_Jmn_Fga Data\"]){",
                  "    tests[\"Delete data Sum up\"] = true; ",
                  "    postman.setNextRequest(\"[011102400]Drop file FGA\");",
                  "}",
                  "else {",
                  "   tests[\"Delete data Sum up\"] = fase; ",
                  "   //postman.setNextRequest(null);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/customSQL/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{  \r\n   \"sqlRequest\":[  \r\n      {  \r\n         \"requestId\":\"UpdatePointData\",\r\n         \"requestContent\":\"update point set uidqualite_point='15', valeur='0' where uidpoint in (select po.uidpoint from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and po.HORODATE >= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('24/02/2017 05:00:00','DD/MM/YYYY HH24:MI:SS') and Idfga in ('C220'))\"\r\n      },\r\n            {  \r\n         \"requestId\":\"DeletePointData\",\r\n         \"requestContent\":\"delete from point where uidpoint in (select po.uidpoint from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and po.HORODATE >= TO_DATE('23/02/2017 09:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('23/02/2017 09:00:00','DD/MM/YYYY HH24:MI:SS') and Idfga in ('C220'))\"\r\n      },\r\n      {  \r\n         \"requestId\":\"DeleteAcqFgaData\",\r\n         \"requestContent\":\"delete from acq_fga_conservee where uidacq_fga_conservee in (select uidacq_fga_conservee from acq_fga_conservee where code_acquisition in ('C220', 'SGGU2802E1'))\"\r\n      },\r\n      {  \r\n         \"requestId\":\"DeletePubPointJmnFgaData\",\r\n         \"requestContent\":\"delete from pub_point_jmn_fga where uidgrandeur in (select pp.uidgrandeur from pub_point_jmn_fga pp, fga p, grandeur g, GRANDEURS_OBJET go where  pp.uidgrandeur=g.UIDGRANDEUR and g.UIDGRANDEURS_OBJET=go.UIDGRANDEURS_OBJET and go.uidgrandeurs_objet=p.uidgrandeurs_objet and p.idfga='C220' and horodate between TO_DATE('2017-02-23 06:00:00', 'YYYY-MM-DD HH24:MI:SS')and TO_DATE('2017-02-24 05:00:00', 'YYYY-MM-DD HH24:MI:SS'))\"\r\n      }\r\n   ]\r\n}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "9a7dff24-2295-7f98-e9da-6ee7c275449d",
          "name": "[011102400]Drop file FGA",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "postman.setEnvironmentVariable(\"[011102400]PRO_ACG_11_FGA_ACG_024_C220_processid\",jsonData.processId);",
                  "postman.setEnvironmentVariable(\"[011102400]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\",jsonData.sourceProcessId);",
                  "",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check drop file FGA\"] = true; ",
                  "   postman.setNextRequest(\"[011102400]Check process cal end\");",
                  "}",
                  "else {",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/files/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"alias\":\"SCALA_FGA\",\"fileName\":\"H20170223_FGA_20170223105002_CHR02_SCALA_18-1F.xml.gz\",\"wait\":\"true\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "ed238719-2929-ed0b-511d-31a4e2c312ad",
          "name": "[011102400]Check process cal end",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check process cal end\"] = true; ",
                  "   postman.setNextRequest(\"[011102400]Check data\");",
                  "}",
                  "else {",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/checkProcess/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"processCode\":\"PRO_CAL_02\",\"processId\":\"{{[011102400]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId}}\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "c61ffff0-b2bc-a792-41fa-46adb3b20f98",
          "name": "[011102400]Check data",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "var sqlResult = jsonData.sqlResult;",
                  "if(sqlResult != null){",
                  "    for(var i= 0; i < sqlResult.length; i++)",
                  "    {",
                  "        if(sqlResult[i].results != null){",
                  "            switch (sqlResult[i].requestId) {",
                  "            case \"CheckStatutOrcProcessus\":",
                  "                tests[\"Check status in ORC_PROCESSUS\"] = sqlResult[i].results[0].ID_STATUT_PROCESSUS == \"4\";",
                  "                break;",
                  "            case \"CheckAcqFgaConservee\":",
                  "                tests[\"Check ACQ_FGA_CONSERVEE\"] = sqlResult[i].results[0].COUNT == \"1\";",
                  "                break;",
                  "            case \"CheckStockAcquisition2\":",
                  "                    tests[\"Check STOCK_ACQUISITION2\"] = sqlResult[i].results[0].COUNT == \"5\";",
                  "                break;",
                  "            case \"CheckDmdCalcul\":",
                  "                tests[\"Check DMD_CALCUL\"] = sqlResult[i].results[0].COUNT == \"1\";",
                  "                break;",
                  "            case \"CheckStockAcquisitionCal\":",
                  "                tests[\"Check STOCK_ACQUISITION_CAL\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;",
                  "            case \"CheckPointData\":",
                  "                tests[\"Check POINT data\"] = sqlResult[i].results[0].COUNT == \"130\";",
                  "                break;",
                  "            case \"CheckPubPointJmnFgaData\":",
                  "                tests[\"Check PUB_POINT_JMN_FGA data\"] = sqlResult[i].results[0].COUNT == \"130\";",
                  "                break;",
                  "            case \"CheckStockAcquisitionForAcq\":",
                  "                tests[\"Check STOCK_ACQUISITION for Acq\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;   ",
                  "            case \"CheckStockAcquisitionForCal\":",
                  "                tests[\"Check STOCK_ACQUISITION For Cal\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break; ",
                  "            }",
                  "        }",
                  "    }",
                  "}",
                  "postman.setNextRequest(\"[011102401]Drop file FGA\");",
                  ""
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "//postman.setNextRequest(null);",
                  "",
                  ""
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/customSQL/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{  \r\n   \"sqlRequest\":[  \r\n      {  \r\n         \"requestId\":\"CheckStatutOrcProcessus\",\r\n         \"requestContent\":\"select id_statut_processus from orc_processus where id_correlation='{{[011102400]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckAcqFgaConservee\",\r\n         \"requestContent\":\"select count(*) as COUNT from acq_fga_conservee where code_acquisition in ('C220') and jour_gazier= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and lstime >= sysdate-1/24\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisition2\",\r\n         \"requestContent\":\"SELECT stockage,count(*) as COUNT from (select date_mesure,stockage from stock_acquisition2 where processid in ('{{[011102400]PRO_ACG_11_FGA_ACG_024_C220_processid}}') and stockage='OUI' group by nom_source,date_mesure,processid,pas_chr,stockage order by date_mesure, processid desc) group by stockage order by stockage\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckDmdCalcul\",\r\n         \"requestContent\":\"select count(*) as COUNT from dmd_calcul where prec_processid='{{[011102400]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition_cal where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102400]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckPointData\",\r\n         \"requestContent\":\"select count(*) as COUNT from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and ((po.HORODATE >= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('24/02/2017 05:00:00','DD/MM/YYYY HH24:MI:SS') )) and Idfga in ('C220') and po.lstime >= (sysdate-1/24/4)\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckPubPointJmnFgaData\",\r\n         \"requestContent\":\"select count(*) as COUNT from PUB_POINT_jmn_fga pp  inner join grandeur on pp.uidgrandeur = grandeur.uidgrandeur  where  horodate between TO_DATE('2017-02-23 06:00:00', 'YYYY-MM-DD HH24:MI:SS')and TO_DATE('2017-02-24 05:00:00', 'YYYY-MM-DD HH24:MI:SS')  and idgrandeur like '%C220%'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForAcq\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where lstime >=(sysdate-1/24) and processid='{{[011102400]PRO_ACG_01_FGA_TNR_SGTUH97A_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102400]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      }\r\n   ]\r\n}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "7d8041f4-397b-ef7f-be98-291e931f8d9a",
          "name": "[011102401]Drop file FGA",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "postman.setEnvironmentVariable(\"[011102401]PRO_ACG_11_FGA_ACG_024_C220_processid\",jsonData.processId);",
                  "postman.setEnvironmentVariable(\"[011102401]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\",jsonData.sourceProcessId);",
                  "",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check drop file FGA\"] = true; ",
                  "   postman.setNextRequest(\"[011102401]Check process cal end\");",
                  "}",
                  "else {",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/files/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"alias\":\"SCALA_FGA\",\"fileName\":\"H20170223_FGA_20170223105003_CHR02_SCALA_18-1F.xml.gz\",\"wait\":\"true\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "1234cc9a-78d6-48e1-483b-631746dc6272",
          "name": "[011102401]Check process cal end",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check process cal end\"] = true; ",
                  "   postman.setNextRequest(\"[011102401]Check data\");",
                  "}",
                  "else {",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var sourcprocessid = postman.getEnvironmentVariable(\"[011102401]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\");",
                  "console.log(sourcprocessid);"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/checkProcess/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"processCode\":\"PRO_CAL_02\",\"processId\":\"{{[011102401]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId}}\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "f24cd023-b15c-f938-1435-d28408efc3bd",
          "name": "[011102401]Check data",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "var sqlResult = jsonData.sqlResult;",
                  "if(sqlResult != null){",
                  "    for(var i= 0; i < sqlResult.length; i++)",
                  "    {",
                  "        if(sqlResult[i].results != null){",
                  "            switch (sqlResult[i].requestId) {",
                  "            case \"CheckStatutOrcProcessus\":",
                  "                tests[\"Check status in ORC_PROCESSUS\"] = sqlResult[i].results[0].ID_STATUT_PROCESSUS == \"4\";",
                  "                break;",
                  "            case \"CheckAcqFgaConservee\":",
                  "                tests[\"Check ACQ_FGA_CONSERVEE\"] = sqlResult[i].results[0].COUNT == \"1\";",
                  "                break;",
                  "            case \"CheckStockAcquisition2\":",
                  "                //Expected result : 8AM should be set to OUI , and NON for 7 and 9",
                  "                if (sqlResult[i].results.length ==4){",
                  "                    if (sqlResult[i].results[0].STOCKAGE==\"OUI\" && sqlResult[i].results[1].STOCKAGE==\"OUI\" && sqlResult[i].results[2].STOCKAGE==\"OUI\" && sqlResult[i].results[3].STOCKAGE==\"NON\"){",
                  "                        tests[\"Check Stock_acquisition2\"]=true;",
                  "                    }",
                  "                    else{",
                  "                        tests[\"Check Stock_acquisition2\"]=false;",
                  "                    }",
                  "                }",
                  "                else{",
                  "                     tests[\"Check Stock_acquisition2\"]=false;",
                  "                }",
                  "                break;",
                  "            case \"CheckDmdCalcul\":",
                  "                tests[\"Check DMD_CALCUL\"] = sqlResult[i].results[0].COUNT == \"1\";",
                  "                break;",
                  "            case \"CheckStockAcquisitionCal\":",
                  "                tests[\"Check STOCK_ACQUISITION_CAL\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;",
                  "            case \"CheckPointData\":",
                  "                tests[\"Check POINT data\"] = sqlResult[i].results[0].COUNT == \"130\";",
                  "                break;",
                  "            case \"CheckPubPointJmnFgaData\":",
                  "                tests[\"Check PUB_POINT_JMN_FGA data\"] = sqlResult[i].results[0].COUNT == \"260\";",
                  "                break;",
                  "            case \"CheckStockAcquisitionForAcq\":",
                  "                tests[\"Check STOCK_ACQUISITION for Acq\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;   ",
                  "            case \"CheckStockAcquisitionForCal\":",
                  "                tests[\"Check STOCK_ACQUISITION For Cal\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break; ",
                  "            }",
                  "        }",
                  "    }",
                  "}",
                  "postman.setNextRequest(\"[011102402]Update data\");",
                  ""
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "//postman.setNextRequest(null);",
                  "",
                  ""
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/customSQL/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{  \r\n   \"sqlRequest\":[  \r\n      {  \r\n         \"requestId\":\"CheckStatutOrcProcessus\",\r\n         \"requestContent\":\"select id_statut_processus from orc_processus where id_correlation='{{[011102401]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckAcqFgaConservee\",\r\n         \"requestContent\":\"select count(*) as COUNT from acq_fga_conservee where code_acquisition in ('C220') and jour_gazier= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and processid='{{[011102401]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisition2\",\r\n         \"requestContent\":\"select date_mesure,stockage from stock_acquisition2 where processid in ('{{[011102401]PRO_ACG_11_FGA_ACG_024_C220_processid}}') group by date_mesure,stockage order by date_mesure asc\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckDmdCalcul\",\r\n         \"requestContent\":\"select count(*) as COUNT from dmd_calcul where prec_processid='{{[011102401]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition_cal where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102401]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckPointData\",\r\n         \"requestContent\":\"select count(*) as COUNT from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and ((po.HORODATE >= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('24/02/2017 05:00:00','DD/MM/YYYY HH24:MI:SS') )) and Idfga in ('C220') and po.lstime >= (sysdate-1/24/4)\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckPubPointJmnFgaData\",\r\n         \"requestContent\":\"select count(*) as COUNT from PUB_POINT_jmn_fga pp  inner join grandeur on pp.uidgrandeur = grandeur.uidgrandeur  where  horodate between TO_DATE('2017-02-23 06:00:00', 'YYYY-MM-DD HH24:MI:SS')and TO_DATE('2017-02-24 05:00:00', 'YYYY-MM-DD HH24:MI:SS')  and idgrandeur like '%C220%'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForAcq\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where lstime >=(sysdate-1/24) and processid='{{[011102401]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102401]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      }\r\n   ]\r\n}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "8ae46bc8-c8df-5368-81f3-6bc0194f79ec",
          "name": "[011102402]Update data",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "var sqlResult = jsonData.sqlResult;",
                  "for(var i= 0; i < sqlResult.length; i++)",
                  "{",
                  "    switch (sqlResult[i].requestId) {",
                  "        case \"UpdatePointData\":",
                  "            tests[\"Update Point Data\"] = true;",
                  "            break;",
                  "    }",
                  "}",
                  "if (tests[\"Update Point Data\"]){",
                  "    tests[\"Update data Sum up\"] = true; ",
                  "    postman.setNextRequest(\"[011102402]Drop file FGA\");",
                  "}",
                  "else {",
                  "   tests[\"Delete data Sum up\"] = fase; ",
                  "   //postman.setNextRequest(null);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/customSQL/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{  \r\n   \"sqlRequest\":[  \r\n      {  \r\n         \"requestId\":\"UpdatePointData\",\r\n         \"requestContent\":\"update point set uidqualite_point='15', valeur='0' where uidpoint in (select po.uidpoint from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and po.HORODATE >= TO_DATE('23/02/2017 07:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('23/02/2017 07:00:00','DD/MM/YYYY HH24:MI:SS') and Idfga in ('C220') and (type_grandeur in ('DENMOY')))\"\r\n      }\r\n   ]\r\n}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "8828ad58-0f1e-bb73-71aa-5e130f006d14",
          "name": "[011102402]Drop file FGA",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "postman.setEnvironmentVariable(\"[011102402]PRO_ACG_11_FGA_ACG_024_C220_processid\",jsonData.processId);",
                  "postman.setEnvironmentVariable(\"[011102402]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\",jsonData.sourceProcessId);",
                  "",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check drop file FGA\"] = true; ",
                  "   postman.setNextRequest(\"[011102402]Check process cal end\");",
                  "}",
                  "else {",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/files/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"alias\":\"SCALA_FGA\",\"fileName\":\"H20170223_FGA_20170223105004_CHR02_SCALA_18-1F.xml.gz\",\"wait\":\"true\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "db0f207e-08d7-2389-f12c-03df81dcb0ec",
          "name": "[011102402]Check process cal end",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check process cal end\"] = true; ",
                  "   postman.setNextRequest(\"[011102402]Check data\");",
                  "}",
                  "else {",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var sourcprocessid = postman.getEnvironmentVariable(\"[011102401]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\");",
                  "console.log(sourcprocessid);"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/checkProcess/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"processCode\":\"PRO_CAL_02\",\"processId\":\"{{[011102402]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId}}\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "91b97d6c-8c7e-0121-2a21-d81a5c6f57b9",
          "name": "[011102402]Check data",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "var sqlResult = jsonData.sqlResult;",
                  "if(sqlResult != null){",
                  "    for(var i= 0; i < sqlResult.length; i++)",
                  "    {",
                  "        if(sqlResult[i].results != null){",
                  "            switch (sqlResult[i].requestId) {",
                  "            case \"CheckStatutOrcProcessus\":",
                  "                tests[\"Check status in ORC_PROCESSUS\"] = sqlResult[i].results[0].ID_STATUT_PROCESSUS == \"4\";",
                  "                break;",
                  "            case \"CheckAcqFgaConservee\":",
                  "                tests[\"Check ACQ_FGA_CONSERVEE\"] = sqlResult[i].results[0].COUNT == \"1\";",
                  "                break;",
                  "            case \"CheckStockAcquisition2\":",
                  "                //Expected result : 8AM should be set to OUI , and NON for 7 and 9",
                  "                if (sqlResult[i].results.length ==4){",
                  "                    if (sqlResult[i].results[0].STOCKAGE==\"NON\" && sqlResult[i].results[1].STOCKAGE==\"OUI\" && sqlResult[i].results[2].STOCKAGE==\"OUI\" && sqlResult[i].results[3].STOCKAGE==\"NON\"){",
                  "                        tests[\"Check Stock_acquisition2\"]=true;",
                  "                    }",
                  "                    else{",
                  "                        tests[\"Check Stock_acquisition2\"]=false;",
                  "                    }",
                  "                }",
                  "                else{",
                  "                     tests[\"Check Stock_acquisition2\"]=false;",
                  "                }",
                  "                break;",
                  "            case \"CheckDmdCalcul\":",
                  "                tests[\"Check DMD_CALCUL\"] = sqlResult[i].results[0].COUNT == \"1\";",
                  "                break;",
                  "            case \"CheckStockAcquisitionCal\":",
                  "                tests[\"Check STOCK_ACQUISITION_CAL\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;",
                  "            case \"CheckPointData\":",
                  "                tests[\"Check POINT data\"] = sqlResult[i].results[0].COUNT == \"130\";",
                  "                break;",
                  "            case \"CheckStockAcquisitionForAcq\":",
                  "                tests[\"Check STOCK_ACQUISITION for Acq\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;   ",
                  "            case \"CheckStockAcquisitionForCal\":",
                  "                tests[\"Check STOCK_ACQUISITION For Cal\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break; ",
                  "            }",
                  "        }",
                  "    }",
                  "}",
                  "postman.setNextRequest(\"[011102403]Drop file FGA\");",
                  ""
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "//postman.setNextRequest(null);",
                  "",
                  ""
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/customSQL/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{  \r\n   \"sqlRequest\":[  \r\n      {  \r\n         \"requestId\":\"CheckStatutOrcProcessus\",\r\n         \"requestContent\":\"select id_statut_processus from orc_processus where id_correlation='{{[011102402]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckAcqFgaConservee\",\r\n         \"requestContent\":\"select count(*) as COUNT from acq_fga_conservee where code_acquisition in ('C220') and jour_gazier= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and processid='{{[011102402]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisition2\",\r\n         \"requestContent\":\"select date_mesure,stockage from stock_acquisition2 where processid in ('{{[011102402]PRO_ACG_11_FGA_ACG_024_C220_processid}}') and PAS_CHR='3600' group by date_mesure,stockage order by date_mesure asc\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckDmdCalcul\",\r\n         \"requestContent\":\"select count(*) as COUNT from dmd_calcul where prec_processid='{{[011102402]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition_cal where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102402]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckPointData\",\r\n         \"requestContent\":\"select count(*) as COUNT from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and ((po.HORODATE >= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('24/02/2017 05:00:00','DD/MM/YYYY HH24:MI:SS') )) and Idfga in ('C220') and po.lstime >= (sysdate-1/24/4)\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForAcq\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where lstime >=(sysdate-1/24) and processid='{{[011102402]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102402]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      }\r\n   ]\r\n}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "caa3f0b0-f5b5-ac1a-523b-71f86eaf06bc",
          "name": "[011102403]Drop file FGA",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "postman.setEnvironmentVariable(\"[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid\",jsonData.processId);",
                  "postman.setEnvironmentVariable(\"[011102403]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\",jsonData.sourceProcessId);",
                  "",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check drop file FGA\"] = true; ",
                  "   postman.setNextRequest(\"[011102403]Check process cal end\");",
                  "}",
                  "else {",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/files/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"alias\":\"SCALA_FGA\",\"fileName\":\"H20170223_FGA_20170223105004_CHR02_SCALA_18-1F.xml.gz\",\"wait\":\"true\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "681911fe-8ef5-9197-2315-a1d04c44a098",
          "name": "[011102403]Check process cal end",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check process cal end\"] = true; ",
                  "   postman.setNextRequest(\"[011102403]Check data\");",
                  "}",
                  "else {",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var sourcprocessid = postman.getEnvironmentVariable(\"[011102401]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\");",
                  "console.log(sourcprocessid);"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/checkProcess/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"processCode\":\"PRO_CAL_02\",\"processId\":\"{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId}}\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "19cacd33-2f51-d47d-e509-f7b54d82e9b7",
          "name": "[011102403]Check data",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "var sqlResult = jsonData.sqlResult;",
                  "if(sqlResult != null){",
                  "    for(var i= 0; i < sqlResult.length; i++)",
                  "    {",
                  "        if(sqlResult[i].results != null){",
                  "            switch (sqlResult[i].requestId) {",
                  "            case \"CheckStatutOrcProcessus\":",
                  "                tests[\"Check status in ORC_PROCESSUS\"] = sqlResult[i].results[0].ID_STATUT_PROCESSUS == \"4\";",
                  "                break;",
                  "            case \"CheckAcqFgaConservee\":",
                  "                tests[\"Check ACQ_FGA_CONSERVEE\"] = sqlResult[i].results[0].COUNT == \"1\";",
                  "                break;",
                  "            case \"CheckStockAcquisition2\":",
                  "                //Expected result : 8AM should be set to OUI , and NON for 7 and 9",
                  "                if (sqlResult[i].results.length ==4){",
                  "                    if (sqlResult[i].results[0].STOCKAGE==\"NON\" && sqlResult[i].results[1].STOCKAGE==\"NON\" && sqlResult[i].results[2].STOCKAGE==\"OUI\" && sqlResult[i].results[3].STOCKAGE==\"NON\"){",
                  "                        tests[\"Check Stock_acquisition2\"]=true;",
                  "                    }",
                  "                    else{",
                  "                        tests[\"Check Stock_acquisition2\"]=false;",
                  "                    }",
                  "                }",
                  "                else{",
                  "                     tests[\"Check Stock_acquisition2\"]=false;",
                  "                }",
                  "                break;",
                  "            case \"CheckDmdCalcul\":",
                  "                tests[\"Check DMD_CALCUL\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;",
                  "            case \"CheckStockAcquisitionCal\":",
                  "                tests[\"Check STOCK_ACQUISITION_CAL\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;",
                  "            case \"CheckPointData\":",
                  "                tests[\"Check POINT data\"] = sqlResult[i].results[0].COUNT == \"130\";",
                  "                break;",
                  "",
                  "            case \"CheckStockAcquisitionForAcq\":",
                  "                tests[\"Check STOCK_ACQUISITION for Acq\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;   ",
                  "            case \"CheckStockAcquisitionForCal\":",
                  "                tests[\"Check STOCK_ACQUISITION For Cal\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break; ",
                  "            }",
                  "        }",
                  "    }",
                  "}",
                  "postman.setNextRequest(\"[00002]Delete data\");",
                  ""
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "//postman.setNextRequest(null);",
                  "",
                  ""
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/customSQL/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{  \r\n   \"sqlRequest\":[  \r\n      {  \r\n         \"requestId\":\"CheckStatutOrcProcessus\",\r\n         \"requestContent\":\"select id_statut_processus from orc_processus where id_correlation='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckAcqFgaConservee\",\r\n         \"requestContent\":\"select count(*) as COUNT from acq_fga_conservee where code_acquisition in ('C220') and jour_gazier= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisition2\",\r\n         \"requestContent\":\"select date_mesure,stockage from stock_acquisition2 where processid in ('{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}') group by date_mesure,stockage order by date_mesure asc\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckDmdCalcul\",\r\n         \"requestContent\":\"select count(*) as COUNT from dmd_calcul where prec_processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition_cal where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckPointData\",\r\n         \"requestContent\":\"select count(*) as COUNT from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and ((po.HORODATE >= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('24/02/2017 05:00:00','DD/MM/YYYY HH24:MI:SS') )) and Idfga in ('C220') and po.lstime >= (sysdate-1/24/4)\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForAcq\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where lstime >=(sysdate-1/24) and processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      }\r\n   ]\r\n}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "be9f712f-bf37-3c4d-84b5-c04409753788",
          "name": "[011102404]Drop file FGA",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "postman.setEnvironmentVariable(\"[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid\",jsonData.processId);",
                  "postman.setEnvironmentVariable(\"[011102403]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\",jsonData.sourceProcessId);",
                  "",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check drop file FGA\"] = true; ",
                  "   postman.setNextRequest(\"[011102403]Check process cal end\");",
                  "}",
                  "else {",
                  "    tests[\"Check drop file FGA\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/files/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"alias\":\"SCALA_FGA\",\"fileName\":\"H20170223_FGA_20170223105004_CHR02_SCALA_18-1F.xml.gz\",\"wait\":\"true\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "9b8b5b3b-7ffb-cf76-39b8-c8a428def5c9",
          "name": "[011102403]Check process cal end copy",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "if (jsonData.statusProcess === \"2\"){",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);",
                  "}",
                  "else if (jsonData.statusProcess === \"4\"){",
                  "   tests[\"Check process cal end\"] = true; ",
                  "   postman.setNextRequest(\"[011102403]Check data\");",
                  "}",
                  "else {",
                  "    tests[\"Check process cal end\"] = false;",
                  "    //postman.setNextRequest(null);  ",
                  "}"
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var sourcprocessid = postman.getEnvironmentVariable(\"[011102401]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId\");",
                  "console.log(sourcprocessid);"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/checkProcess/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"processCode\":\"PRO_CAL_02\",\"processId\":\"{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_sourceProcessId}}\",\"waitTimeout\":\"90\"}"
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "f2139f97-0bd1-52d5-a36f-43e200fb62c3",
          "name": "[011102403]Check data copy",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "var sqlResult = jsonData.sqlResult;",
                  "if(sqlResult != null){",
                  "    for(var i= 0; i < sqlResult.length; i++)",
                  "    {",
                  "        if(sqlResult[i].results != null){",
                  "            switch (sqlResult[i].requestId) {",
                  "            case \"CheckStatutOrcProcessus\":",
                  "                tests[\"Check status in ORC_PROCESSUS\"] = sqlResult[i].results[0].ID_STATUT_PROCESSUS == \"4\";",
                  "                break;",
                  "            case \"CheckAcqFgaConservee\":",
                  "                tests[\"Check ACQ_FGA_CONSERVEE\"] = sqlResult[i].results[0].COUNT == \"1\";",
                  "                break;",
                  "            case \"CheckStockAcquisition2\":",
                  "                //Expected result : 8AM should be set to OUI , and NON for 7 and 9",
                  "                if (sqlResult[i].results.length ==4){",
                  "                    if (sqlResult[i].results[0].STOCKAGE==\"NON\" && sqlResult[i].results[1].STOCKAGE==\"NON\" && sqlResult[i].results[2].STOCKAGE==\"OUI\" && sqlResult[i].results[3].STOCKAGE==\"NON\"){",
                  "                        tests[\"Check Stock_acquisition2\"]=true;",
                  "                    }",
                  "                    else{",
                  "                        tests[\"Check Stock_acquisition2\"]=false;",
                  "                    }",
                  "                }",
                  "                else{",
                  "                     tests[\"Check Stock_acquisition2\"]=false;",
                  "                }",
                  "                break;",
                  "            case \"CheckDmdCalcul\":",
                  "                tests[\"Check DMD_CALCUL\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;",
                  "            case \"CheckStockAcquisitionCal\":",
                  "                tests[\"Check STOCK_ACQUISITION_CAL\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;",
                  "            case \"CheckPointData\":",
                  "                tests[\"Check POINT data\"] = sqlResult[i].results[0].COUNT == \"130\";",
                  "                break;",
                  "",
                  "            case \"CheckStockAcquisitionForAcq\":",
                  "                tests[\"Check STOCK_ACQUISITION for Acq\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break;   ",
                  "            case \"CheckStockAcquisitionForCal\":",
                  "                tests[\"Check STOCK_ACQUISITION For Cal\"] = sqlResult[i].results[0].COUNT == \"0\";",
                  "                break; ",
                  "            }",
                  "        }",
                  "    }",
                  "}",
                  "postman.setNextRequest(\"[00002]Delete data\");",
                  ""
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "//postman.setNextRequest(null);",
                  "",
                  ""
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/customSQL/",
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic QWRtaW5pc3RyYXRvcjptYW5hZ2U=",
                "description": ""
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{  \r\n   \"sqlRequest\":[  \r\n      {  \r\n         \"requestId\":\"CheckStatutOrcProcessus\",\r\n         \"requestContent\":\"select id_statut_processus from orc_processus where id_correlation='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckAcqFgaConservee\",\r\n         \"requestContent\":\"select count(*) as COUNT from acq_fga_conservee where code_acquisition in ('C220') and jour_gazier= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisition2\",\r\n         \"requestContent\":\"select date_mesure,stockage from stock_acquisition2 where processid in ('{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}') group by date_mesure,stockage order by date_mesure asc\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckDmdCalcul\",\r\n         \"requestContent\":\"select count(*) as COUNT from dmd_calcul where prec_processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition_cal where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckPointData\",\r\n         \"requestContent\":\"select count(*) as COUNT from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and ((po.HORODATE >= TO_DATE('23/02/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('24/02/2017 05:00:00','DD/MM/YYYY HH24:MI:SS') )) and Idfga in ('C220') and po.lstime >= (sysdate-1/24/4)\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForAcq\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where lstime >=(sysdate-1/24) and processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}'\"\r\n      },\r\n      {  \r\n         \"requestId\":\"CheckStockAcquisitionForCal\",\r\n         \"requestContent\":\"select count(*) as COUNT from stock_acquisition where processid in (select courant_processid from dmd_calcul where prec_processid='{{[011102403]PRO_ACG_11_FGA_ACG_024_C220_processid}}')\"\r\n      }\r\n   ]\r\n}"
            },
            "description": ""
          },
          "response": []
        }
      ]
    }
  ]
}