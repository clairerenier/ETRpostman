{
  "variables": [],
  "info": {
    "name": "[020000000]PRO-CAL-02",
    "_postman_id": "150513a0-0546-61c9-f9a3-6e7264e7ba39",
    "description": "",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "_postman_id": "8b9c5060-9de6-c218-d983-9a3f9d8b03d6",
      "name": "[0204ALL00ALL]PRO_CAL_04_ALL_ALL_ALL_NSTOUEN_SGPCETVPEC_SGAPIL2_PRC16_GDCORC016",
      "description": "Aim : Check the payload and response of dmd_calcul (Oracle/WM exchanges)\r\no  0 - \r\no  1 -\r\no  2 -\r\n\r\nFGA : NSTOUEN\r\nZQG : PRC16\r\nPCE : SGPCETVPEC\r\nAPIL : SGAPIL2\r\nGDC : GDCORC16\r\n",
      "item": []
    },
    {
      "_postman_id": "a583047c-79d1-40fa-6c53-8e0153cf1c19",
      "name": "[0204ALL00ALL]Delete data",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "if (tests[\"Status code is 200\"]){",
              "    var jsonData = JSON.parse(responseBody);",
              "    var sqlResult = jsonData.sqlResult;",
              "    for(var i= 0; i < sqlResult.length; i++)",
              "    {",
              "        switch (sqlResult[i].requestId) {",
              "            case \"DeletePointDataFGA\":",
              "                tests[\"Delete Point Data FGA\"] = true;",
              "                break;",
              "            case \"DeletePointDataZQG\":",
              "                tests[\"Delete Point Data ZQG\"] = true;",
              "                break;",
              "            case \"DeletePointDataPCE\":",
              "                tests[\"Delete Point Data PCE\"] = true;",
              "                break;",
              "            case \"DeletePointDataAPIL\":",
              "                tests[\"Delete Point Data APIL\"] = true;",
              "                break;",
              "            case \"DeletePointDataGDC\":",
              "                tests[\"Delete Point Data GDC\"] = true;",
              "                break;",
              "            case \"DeleteAcqFgaData\":",
              "                tests[\"Delete Acq_Fga Data\"] = true;",
              "                break;",
              "            case \"DeleteAcqPceData\":",
              "                tests[\"Delete Acq_Pce Data\"] = true;",
              "                break;",
              "        }",
              "    }",
              "    if ( tests[\"Delete Point Data FGA\"] && tests[\"Delete Point Data ZQG\"] && tests[\"Delete Point Data PCE\"] && tests[\"Delete Point Data APIL\"] && tests[\"Delete Point Data GDC\"] && tests[\"Delete Acq_Fga Data\"] && tests[\"Delete Acq_Fga Data\"]){",
              "        tests[\"Delete data Sum up\"] = true; ",
              "        postman.setNextRequest(\"[0204ALL00ALL]Drop file PCE\");",
              "    }",
              "    else {",
              "       tests[\"Delete data Sum up\"] = fase; ",
              "       //postman.setNextRequest(null);",
              "    }",
              "}",
              "else{",
              "    postman.setNextRequest(null);",
              "}",
              "",
              ""
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{user}}:{{password}}@{{ipPort}}/rest/ETR_FRMK_ADMIN/ws/tests/customSQL/",
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \r\n   \"sqlRequest\":[  \r\n      {  \r\n         \"requestId\":\"DeletePointDataFGA\",\r\n         \"requestContent\":\"delete from point where uidpoint in (select po.uidpoint from fga p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and po.HORODATE >= TO_DATE('01/07/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('02/07/2017 09:00:00','DD/MM/YYYY HH24:MI:SS') and Idfga in ('NSTOUEN','ACHAZ600','BMOBILE2'))\"\r\n      },\r\n      {  \r\n         \"requestId\":\"DeletePointDataZQG\",\r\n         \"requestContent\":\"delete from point where uidpoint in (select po.uidpoint from zqg p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and po.HORODATE >= TO_DATE('01/07/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('02/07/2017 09:00:00','DD/MM/YYYY HH24:MI:SS') and Idzqg in ('PRC16','ORC16'))\"\r\n      },\r\n      {  \r\n         \"requestId\":\"DeletePointDataPCE\",\r\n         \"requestContent\":\"delete from point where uidpoint in (select po.uidpoint from pce p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and po.HORODATE >= TO_DATE('01/07/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('02/07/2017 09:00:00','DD/MM/YYYY HH24:MI:SS') and Idpce in ('SGPCETVPEC','SGPCEEVPEC','SGPCETPIL'))\"\r\n      },\r\n      {  \r\n         \"requestId\":\"DeletePointDataAPIL\",\r\n         \"requestContent\":\"delete from point where uidpoint in (select po.uidpoint from agr_pil p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and po.HORODATE >= TO_DATE('01/07/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('02/07/2017 09:00:00','DD/MM/YYYY HH24:MI:SS') and Idpce in ('SGAPIL2'))\"\r\n      },\r\n      {  \r\n         \"requestId\":\"DeletePointDataGDC\",\r\n         \"requestContent\":\"delete from point where uidpoint in (select po.uidpoint from grp_calcul p,grandeurs_objet gr,grandeur g,point po,qualite_point qpo where p.UIDGRANDEURS_OBJET=gr.UIDGRANDEURS_OBJET and gr.UIDGRANDEURS_OBJET=g.UIDGRANDEURS_OBJET and g.UIDGRANDEUR=po.UIDGRANDEUR and po.UIDQUALITE_POINT=qpo.UIDQUALITE_POINT and po.HORODATE >= TO_DATE('01/07/2017 06:00:00','DD/MM/YYYY HH24:MI:SS') and po.HORODATE <= TO_DATE('02/07/2017 09:00:00','DD/MM/YYYY HH24:MI:SS') and Idgrp_calcul in ('GDCORC16','GDCORC162'))\"\r\n      },\r\n      {  \r\n         \"requestId\":\"DeleteAcqFgaData\",\r\n         \"requestContent\":\"delete from acq_fga_conservee where uidacq_fga_conservee in (select uidacq_fga_conservee from acq_fga_conservee where code_acquisition in ('NSTOUEN','ACHAZ600','BMOBILE2') and jour_gazier= TO_DATE('01/07/2017 06:00:00','DD/MM/YYYY HH24:MI:SS'))\"\r\n      },\r\n       {  \r\n         \"requestId\":\"DeleteAcqPceData\",\r\n         \"requestContent\":\"delete from acq_pce_conservee where uidacq_pce_conservee in (select uidacq_pce_conservee from acq_pce_conservee where code_acquisition in ('SGPCETVPEC','SGPCEEVPEC','SGPCETPIL') and jour_gazier= TO_DATE('01/07/2017 06:00:00','DD/MM/YYYY HH24:MI:SS'))\"\r\n      }\r\n   ]\r\n}"
        },
        "description": ""
      },
      "response": []
    }
  ]
}